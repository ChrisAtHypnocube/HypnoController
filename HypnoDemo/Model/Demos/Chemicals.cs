#region License
// The MIT License (MIT)
// Copyright (c) 2013-2014 Hypnocube, LLC
// 
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
// 
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.
#endregion
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Windows.Media;
using Hypnocube.Demo.Model.Renderer.Math3D;

namespace Hypnocube.Demo.Model.Demos
{
    internal class Chemicals : DemoBase
    {
        // nice source of data http://cccbdb.nist.gov/
        // and http://www.chemspider.com/
        // converter  http://openbabel.org/wiki/Main_Page


        private static Dictionary<string, double> radii;


        private static readonly List<Molecule> KnownMolecules;

        private static string atomicRadii =
            "1	H	hydrogen	25            \n" +
            "2	He	helium	31                \n" +
            "3	Li	lithium	145               \n" +
            "4	Be	beryllium	105           \n" +
            "5	B	boron	85                \n" +
            "6	C	carbon	70                \n" +
            "7	N	nitrogen	65            \n" +
            "8	O	oxygen	60                \n" +
            "9	F	fluorine	50            \n" +
            "10	Ne	neon	38                \n" +
            "11	Na	sodium	180               \n" +
            "12	Mg	magnesium	150           \n" +
            "13	Al	aluminium	125           \n" +
            "14	Si	silicon	110               \n" +
            "15	P	phosphorus	100           \n" +
            "16	S	sulfur	100               \n" +
            "17	Cl	chlorine	100           \n" +
            "18	Ar	argon	71                \n" +
            "19	K	potassium	220           \n" +
            "20	Ca	calcium	180               \n" +
            "21	Sc	scandium	160           \n" +
            "22	Ti	titanium	140           \n" +
            "23	V	vanadium	135           \n" +
            "24	Cr	chromium	140           \n" +
            "25	Mn	manganese	140           \n" +
            "26	Fe	iron	140               \n" +
            "27	Co	cobalt	135               \n" +
            "28	Ni	nickel	135               \n" +
            "29	Cu	copper	135               \n" +
            "30	Zn	zinc	135               \n" +
            "31	Ga	gallium	130               \n" +
            "32	Ge	germanium	125           \n" +
            "33	As	arsenic	115               \n" +
            "34	Se	selenium	115           \n" +
            "35	Br	bromine	115               \n" +
            "36	Kr	krypton	88                \n" +
            "37	Rb	rubidium	235           \n" +
            "38	Sr	strontium	200           \n" +
            "39	Y	yttrium	180               \n" +
            "40	Zr	zirconium	155           \n" +
            "41	Nb	niobium	145               \n" +
            "42	Mo	molybdenum	145           \n" +
            "43	Tc	technetium	135           \n" +
            "44	Ru	ruthenium	130           \n" +
            "45	Rh	rhodium	135               \n" +
            "46	Pd	palladium	140           \n" +
            "47	Ag	silver	160               \n" +
            "48	Cd	cadmium	155               \n" +
            "49	In	indium	155               \n" +
            "50	Sn	tin	145                   \n" +
            "51	Sb	antimony	145           \n" +
            "52	Te	tellurium	140           \n" +
            "53	I	iodine	140               \n" +
            "54	Xe	xenon	108               \n" +
            "55	Cs	caesium	260               \n" +
            "56	Ba	barium	215               \n" +
            "57	La	lanthanum	195           \n" +
            "58	Ce	cerium	185               \n" +
            "59	Pr	praseodymium	185       \n" +
            "60	Nd	neodymium	185           \n" +
            "61	Pm	promethium	185           \n" +
            "62	Sm	samarium	185           \n" +
            "63	Eu	europium	185           \n" +
            "64	Gd	gadolinium	180           \n" +
            "65	Tb	terbium	175               \n" +
            "66	Dy	dysprosium	175           \n" +
            "67	Ho	holmium	175               \n" +
            "68	Er	erbium	175               \n" +
            "69	Tm	thulium	175               \n" +
            "70	Yb	ytterbium	175           \n" +
            "71	Lu	lutetium	175           \n" +
            "72	Hf	hafnium	155               \n" +
            "73	Ta	tantalum	145           \n" +
            "74	W	tungsten	135           \n" +
            "75	Re	rhenium	135               \n" +
            "76	Os	osmium	130               \n" +
            "77	Ir	iridium	135               \n" +
            "78	Pt	platinum	135           \n" +
            "79	Au	gold	135               \n" +
            "80	Hg	mercury	150               \n" +
            "81	Tl	thallium	190           \n" +
            "82	Pb	lead	180               \n" +
            "83	Bi	bismuth	160               \n" +
            "84	Po	polonium	190           \n" +
            "85	At	astatine	202           \n" +
            "86	Rn	radon	220               \n" +
            "87	Fr	francium	348           \n" +
            "88	Ra	radium	215               \n" +
            "89	Ac	actinium	195           \n" +
            "90	Th	thorium	180               \n" +
            "91	Pa	protactinium	180       \n" +
            "92	U	uranium	175               \n" +
            "93	Np	neptunium	175           \n" +
            "94	Pu	plutonium	175           \n" +
            "95	Am	americium	175           \n" +
            "96	Cm	curium	174               \n" +
            "97	Bk	berkelium	170           \n" +
            "98	Cf	californium	186           \n" +
            "99	Es	einsteinium	186           \n" +
            "104	Rf	rutherfordium	131   \n" +
            "105	Db	dubnium	126           \n" +
            "106	Sg	seaborgium	121       \n" +
            "107	Bh	bohrium	119           \n" +
            "108	Hs	hassium	118           \n" +
            "109	Mt	meitnerium	113       \n" +
            "110	Ds	darmstadtium	112   \n" +
            "111	Rg	roentgenium	118       \n" +
            "112	Cn	copernicium	130       \n";

        private static string chemicals =
            "Test,,,,,,,,,,,,,,,,                                      \n" +
            "2,0,0,1,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-0.5,0,0,O,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "0.5,0,0,O,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            ",,,,,,,,,,,,,,,,                                      \n" +
            "Glucose,,,,,,,,,,,,,,,,                                      \n" +
            "24,24,0,1,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-0.6679,1.1587,0.257,O,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "-0.887,-2.4483,-0.3388,O,0,0,0,0,0,0,0,0,0,0,0,0,0           \n" +
            "1.8623,-2.0693,0.4696,O,0,0,0,0,0,0,0,0,0,0,0,0,0            \n" +
            "2.8609,0.5414,-0.4619,O,0,0,0,0,0,0,0,0,0,0,0,0,0            \n" +
            "1.1222,2.6552,0.2574,O,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "-3.3742,0.9717,-0.1865,O,0,0,0,0,0,0,0,0,0,0,0,0,0           \n" +
            "-0.3727,-1.247,0.23,C,0,0,1,0,0,0,0,0,0,0,0,0,0              \n" +
            "1.0856,-1.0709,-0.194,C,0,0,1,0,0,0,0,0,0,0,0,0,0            \n" +
            "-1.2211,-0.0621,-0.2375,C,0,0,1,0,0,0,0,0,0,0,0,0,0          \n" +
            "1.6082,0.3151,0.1839,C,0,0,2,0,0,0,0,0,0,0,0,0,0             \n" +
            "0.6388,1.4132,-0.2534,C,0,0,1,0,0,0,0,0,0,0,0,0,0            \n" +
            "-2.655,-0.1577,0.274,C,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "-0.4248,-1.3522,1.3206,H,0,0,0,0,0,0,0,0,0,0,0,0,0           \n" +
            "1.2066,-1.2487,-1.2697,H,0,0,0,0,0,0,0,0,0,0,0,0,0           \n" +
            "-1.2548,-0.0098,-1.3343,H,0,0,0,0,0,0,0,0,0,0,0,0,0          \n" +
            "1.7952,0.3598,1.2636,H,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "0.5967,1.5141,-1.344,H,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "-2.6916,-0.1535,1.3685,H,0,0,0,0,0,0,0,0,0,0,0,0,0           \n" +
            "-3.1564,-1.0581,-0.0922,H,0,0,0,0,0,0,0,0,0,0,0,0,0          \n" +
            "-0.8514,-2.3615,-1.3066,H,0,0,0,0,0,0,0,0,0,0,0,0,0          \n" +
            "1.4973,-2.9356,0.22,H,0,0,0,0,0,0,0,0,0,0,0,0,0              \n" +
            "2.7165,0.4989,-1.4227,H,0,0,0,0,0,0,0,0,0,0,0,0,0            \n" +
            "1.4876,2.5033,1.1448,H,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "-2.9192,1.7652,0.144,H,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "1,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "2,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,20,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,21,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,22,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,23,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,24,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "7,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "7,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "10,11,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "10,16,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "11,17,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,18,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,19,1,0,0,0,0,,,,,,,,,,                                    \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "methane,,,,,,,,,,,,,,,,                                      \n" +
            "5,4,0,0,0,0,0,0,999,V2000,,,,,,,                             \n" +
            "0,0,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                             \n" +
            "0.5541,0.7996,0.4965,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.6833,-0.8134,-0.2536,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.7782,-0.3735,0.6692,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.4593,0.3874,-0.9121,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1,2,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,3,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Caffiene,,,,,,,,,,,,,,,,                                     \n" +
            "24,25,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "0.47,2.5688,0.0006,O,0,0,0,0,0,0,0,0,0,0,0,0,                \n" +
            "-3.1271,-0.4436,-0.0003,O,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-0.9686,-1.3125,0,N,0,0,0,0,0,0,0,0,0,0,0,0,                 \n" +
            "2.2182,0.1412,-0.0003,N,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-1.3477,1.0797,-0.0001,N,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.4119,-1.9372,0.0002,N,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.8579,0.2592,-0.0008,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.3897,-1.0264,-0.0004,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.0307,1.422,-0.0006,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.9061,-0.2495,-0.0004,C,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "2.5032,-1.1998,0.0003,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-1.4276,-2.696,0.0008,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.1926,1.2061,0.0003,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-2.2969,2.1881,0.0007,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.5163,-1.5787,0.0008,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-1.0451,-3.1973,-0.8937,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-2.5186,-2.7596,0.0011,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-1.0447,-3.1963,0.8957,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "4.1992,0.7801,0.0002,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "3.0468,1.8092,-0.8992,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.0466,1.8083,0.9004,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.8087,3.1651,-0.0003,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.9322,2.1027,0.8881,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.9346,2.1021,-0.8849,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1,9,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,10,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "6,11,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,8,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "7,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "11,15,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,16,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,17,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,18,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,19,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,20,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,21,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,22,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,23,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,24,1,0,0,0,0,,,,,,,,,,                                    \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Cyclohexane,,,,,,,,,,,,,,,,                                  \n" +
            "18,18,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-0.0435,-1.4573,-0.2258,C,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "1.2404,-0.7663,0.2258,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-1.2838,-0.691,0.2258,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1.2838,0.6911,-0.2257,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-1.2404,0.7662,-0.2258,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.0435,1.4573,0.2258,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-0.046,-1.5425,-1.3194,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.0739,-2.4771,0.1741,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.3129,-0.8111,1.3194,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "2.1083,-1.3026,-0.1742,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.1821,-1.1746,-0.1741,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-1.3588,-0.7314,1.3195,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "2.1821,1.1746,0.1742,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "1.359,0.7315,-1.3194,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.3129,0.811,-1.3195,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.1083,1.3025,0.1741,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.0459,1.5425,1.3195,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.0738,2.4771,-0.1742,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1,2,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,3,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,6,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,6,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,16,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,17,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,18,1,0,0,0,0,,,,,,,,,,                                     \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Carbon Tetrachloride,,,,,,,,,,,,,,,,                         \n" +
            "5,4,0,0,0,0,0,0,999,V2000,,,,,,,                             \n" +
            "0.7071,1.2237,-1.0849,Cl,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.3068,-0.9165,0.7922,Cl,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-1.019,-1.1147,-0.9456,Cl,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-0.9949,0.8076,1.2378,Cl,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0,-0.0002,0.0004,C,0,0,0,0,0,0,0,0,0,0,0,0,                  \n" +
            "1,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            //"Salt,,,,,,,,,,,,,,,,                                         \n" +
            //"2,0,0,0,0,0,0,0,999,V2000,,,,,,,                             \n" +
            //"2,0,0,Cl,0,5,0,0,0,0,0,0,0,0,0,0,                            \n" +
            //"3,0,0,Na,0,3,0,0,0,0,0,0,0,0,0,0,                            \n" +
            //",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Aspirin,,,,,,,,,,,,,,,,                                      \n" +
            "21,21,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "1.2333,0.554,0.7792,O,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "-0.6952,-2.7148,-0.7502,O,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "0.7958,-2.1843,0.8685,O,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1.7813,0.8105,-1.4821,O,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.0857,0.6088,0.4403,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.7927,-0.5515,0.1244,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.7288,1.8464,0.4133,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.1426,-0.4741,-0.2184,C,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-2.0787,1.9238,0.0706,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.7855,0.7636,-0.2453,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.1409,-1.8536,0.1477,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "2.1094,0.6715,-0.3113,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.5305,0.5996,0.1635,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-0.1851,2.7545,0.6593,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.7247,-1.3605,-0.4564,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-2.5797,2.8872,0.0506,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-3.8374,0.8238,-0.509,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.729,1.4184,0.8593,H,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "4.2045,0.6969,-0.6924,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.7105,-0.3659,0.6426,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.2555,-3.5916,-0.7337,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "1,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "2,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "2,21,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,11,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,12,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,6,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,7,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "6,8,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "6,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "7,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,10,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,16,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "10,17,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,13,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,18,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,19,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,20,1,0,0,0,0,,,,,,,,,,                                    \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "3-xylene,,,,,,,,,,,,,,,,                                     \n" +
            "18,18,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-1.2079,-0.3369,0.0004,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.2081,-0.3365,-0.0006,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.0003,-1.0341,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                  \n" +
            "-1.2082,1.058,0.0004,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "1.2079,1.0583,-0.0004,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.0003,1.7555,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                  \n" +
            "-2.4997,-1.0822,-0.0004,C,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "2.4998,-1.082,0.0005,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.0004,-2.1217,0.0037,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.1426,1.6128,0.0025,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "2.1422,1.6135,0.0016,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-0.0004,2.8417,0.0011,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-3.2905,-0.5045,-0.491,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.8097,-1.2975,1.027,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.4088,-2.0276,-0.5459,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "2.4107,-2.0252,-0.5492,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "3.2925,-0.5025,-0.4849,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "2.8061,-1.3014,1.0282,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1,3,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,3,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,5,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,6,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,6,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,16,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,17,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,18,1,0,0,0,0,,,,,,,,,,                                     \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "TNT,,,,,,,,,,,,,,,,                                          \n" +
            "21,21,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "2.6057,-1.2353,-1.0982,O,0,5,0,0,0,0,0,0,0,0,0,0,            \n" +
            "2.6039,-1.2369,1.0971,O,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.6953,-2.2155,1.0986,O,0,5,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.6982,-2.2168,-1.0967,O,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-3.1856,0.1963,-1.0982,O,0,5,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-3.186,0.1942,1.097,O,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "2.1653,-0.8259,-0.0007,N,0,3,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.5543,-1.6334,0.0004,N,0,3,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.6022,0.3505,-0.0004,N,0,3,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.4504,1.5036,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                   \n" +
            "1.1223,0.1478,-0.0009,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.2157,-0.2459,-0.0008,C,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-1.2258,0.716,0.0002,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.4403,2.4656,0.001,C,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "-0.8978,2.0718,0.001,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "2.873,1.9639,0.0006,C,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "0.6771,3.5263,0.0018,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.6738,2.8336,0.0016,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.3939,1.606,0.8949,H,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "3.3947,1.6058,-0.893,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "2.9471,3.0571,0.0005,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "1,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,7,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,8,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "6,9,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "7,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "10,11,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "10,14,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "10,16,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "11,12,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,13,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,15,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,15,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,17,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "15,18,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "16,19,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "16,20,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "16,21,1,0,0,0,0,,,,,,,,,,                                    \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "benzene,,,,,,,,,,,,,,,,                                      \n" +
            "12,12,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-1.2131,-0.6884,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                 \n" +
            "-1.2028,0.7064,0.0001,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.0103,-1.3948,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                 \n" +
            "0.0104,1.3948,-0.0001,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1.2028,-0.7063,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                  \n" +
            "1.2131,0.6884,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                   \n" +
            "-2.1577,-1.2244,0,H,0,0,0,0,0,0,0,0,0,0,0,0,                 \n" +
            "-2.1393,1.2564,0.0001,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.0184,-2.4809,-0.0001,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "0.0184,2.4808,0,H,0,0,0,0,0,0,0,0,0,0,0,0,                   \n" +
            "2.1394,-1.2563,0.0001,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "2.1577,1.2245,0,H,0,0,0,0,0,0,0,0,0,0,0,0,                   \n" +
            "1,2,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,3,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,5,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,6,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,6,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Ammonia,,,,,,,,,,,,,,,,                                      \n" +
            "4,3,0,0,0,0,0,0,999,V2000,,,,,,,                             \n" +
            "0,0,0,N,0,0,0,0,0,0,0,0,0,0,0,0,                             \n" +
            "-0.4417,0.2906,0.8711,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.7256,0.6896,-0.1907,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.4875,-0.8701,0.2089,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1,2,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,3,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Chloroform,,,,,,,,,,,,,,,,                                   \n" +
            "5,4,0,0,0,0,0,0,999,V2000,,,,,,,                             \n" +
            "-0.0962,-1.6789,0.1394,Cl,0,0,0,0,0,0,0,0,0,0,0,0,0          \n" +
            "-1.4059,0.9228,0.1394,Cl,0,0,0,0,0,0,0,0,0,0,0,0,0           \n" +
            "1.5022,0.7561,0.1393,Cl,0,0,0,0,0,0,0,0,0,0,0,0,0            \n" +
            "-0.0001,0,-0.4181,C,0,0,0,0,0,0,0,0,0,0,0,0,0                \n" +
            "-0.0001,-0.0001,-1.5111,H,0,0,0,0,0,0,0,0,0,0,0,0,0          \n" +
            "1,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,4,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Isoprene,,,,,,,,,,,,,,,,                                     \n" +
            "13,12,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-0.5185,0.0447,-0.0001,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.6822,-1.4501,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                 \n" +
            "0.8202,0.6168,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                   \n" +
            "-1.5949,0.8486,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                  \n" +
            "1.9754,-0.06,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                    \n" +
            "-0.2221,-1.8912,-0.8909,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-1.737,-1.7472,0.0001,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.2221,-1.8911,0.8909,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.8832,1.7038,0.0001,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-2.6016,0.4428,0,H,0,0,0,0,0,0,0,0,0,0,0,0,                  \n" +
            "-1.5045,1.9305,0,H,0,0,0,0,0,0,0,0,0,0,0,0,                  \n" +
            "2.9182,0.4777,0,H,0,0,0,0,0,0,0,0,0,0,0,0,                   \n" +
            "2.0229,-1.1428,-0.0001,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1,2,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,3,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,4,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,6,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,5,2,0,0,0,0,,,,,,,,,,                                      \n" +
            "3,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "4,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "water,,,,,,,,,,,,,,,,                                        \n" +
            "3,2,0,0,0,0,0,0,999,V2000,,,,,,,                             \n" +
            "0,0,0,O,0,0,0,0,0,0,0,0,0,0,0,0,0                            \n" +
            "0.2774,0.8929,0.2544,H,0,0,0,0,0,0,0,0,0,0,0,0,0             \n" +
            "0.6068,-0.2383,-0.7169,H,0,0,0,0,0,0,0,0,0,0,0,0,0           \n" +
            "1,2,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,3,1,0,0,0,0,,,,,,,,,,                                      \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "LSD,,,,,,,,,,,,,,,,                                          \n" +
            "49,52,0,1,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "2.4802,1.6091,1.0171,O,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.4729,-2.2418,0.4751,N,0,0,2,0,0,0,0,0,0,0,0,0,             \n" +
            "-5.1983,-0.2437,0.1998,N,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "4.1981,0.4702,-0.0574,N,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.7385,-1.3851,0.5912,C,0,0,1,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.6067,0.0201,-0.0673,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.05,-2.1699,0.2259,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "1.8612,-0.2866,-0.2462,C,0,0,1,0,0,0,0,0,0,0,0,0,            \n" +
            "1.6814,-1.4473,0.7414,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-3.2208,-1.2547,0.2186,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-1.8358,0.8415,-0.1843,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-3.0277,0.1264,-0.0011,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.591,0.4819,-0.4721,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-4.2667,0.7466,-0.0259,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.5883,-2.9739,-0.7864,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "2.8655,0.6842,0.297,C,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "-4.5736,-1.4628,0.3455,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-1.9503,2.2203,-0.4077,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-4.3946,2.1182,-0.2476,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-3.2076,2.8404,-0.4409,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "5.2755,1.3378,0.4008,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "4.6102,-0.6392,-0.9137,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "5.8541,0.8463,1.7169,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "4.5924,-0.2378,-2.3788,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.8336,-1.1669,1.6679,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.205,-2.989,0.9378,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.9844,-2.6039,-0.7784,H,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "2.1425,-0.6596,-1.2324,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "2.5606,-2.1019,0.7495,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1.6242,-1.0642,1.7708,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.6777,1.4409,-0.9767,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.1513,-3.7795,-0.836,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.5626,-3.4714,-0.8601,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.4664,-2.3344,-1.6667,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-5.1544,-2.3592,0.5115,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-1.0678,2.8397,-0.5437,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-6.1978,-0.0995,0.2397,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-5.3619,2.6073,-0.2693,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-3.2646,3.9129,-0.6133,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "6.052,1.4046,-0.3685,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "4.8717,2.3457,0.5488,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "5.6243,-0.9446,-0.6299,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "3.9874,-1.5218,-0.7642,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "5.0837,0.8028,2.494,H,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "6.2792,-0.1572,1.6136,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "6.6467,1.519,2.0585,H,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "3.6067,0.1092,-2.7018,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "5.3016,0.5742,-2.571,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "4.8777,-1.0876,-3.0068,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1,16,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "2,5,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,17,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,37,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,16,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,21,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,22,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,6,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,7,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "5,25,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,13,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,26,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,27,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "8,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,16,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,28,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,29,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,30,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "10,12,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "10,17,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "11,12,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "11,18,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "12,14,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,31,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,19,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "15,32,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "15,33,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "15,34,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "17,35,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "18,20,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "18,36,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "19,20,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "19,38,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "20,39,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "21,23,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "21,40,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "21,41,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "22,24,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "22,42,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "22,43,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "23,44,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "23,45,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "23,46,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "24,47,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "24,48,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "24,49,1,0,0,0,0,,,,,,,,,,                                    \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "Penicillin,,,,,,,,,,,,,,,,                                   \n" +
            "41,43,0,1,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-0.8019,1.2308,0.517,S,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-2.2842,-2.5451,-1.2026,O,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-5.3517,1.076,-0.817,O,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-5.1157,-0.697,0.5961,O,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "2.1598,-2.0405,1.2167,O,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.4781,-0.7369,0.3018,N,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.5677,-1.3807,-0.3375,N,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-1.31,-0.4177,1.1279,C,0,0,1,0,0,0,0,0,0,0,0,0,              \n" +
            "-2.567,1.6679,0.1134,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-3.1671,0.336,-0.3862,C,0,0,2,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.6142,-1.6325,0.499,C,0,0,1,0,0,0,0,0,0,0,0,0,             \n" +
            "-1.9181,-1.8261,-0.3007,C,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "-3.2193,2.2224,1.3871,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.5771,2.7313,-0.9863,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-4.6296,0.1576,-0.1297,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.873,-1.6107,0.1024,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "2.902,-1.2655,-0.9563,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.8679,-0.1949,-0.5225,C,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "3.567,1.1373,-0.7687,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "5.0457,-0.5556,0.1171,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "4.4619,2.129,-0.367,C,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "5.9405,0.4362,0.519,C,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "5.6486,1.7786,0.2769,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.5167,-0.4852,2.1999,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.9961,0.1926,-1.4616,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-0.4509,-2.4585,1.2025,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-3.2655,1.4761,2.1882,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.6724,3.0921,1.7709,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-4.2446,2.5572,1.1944,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.0666,3.6467,-0.6644,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-2.0842,2.3779,-1.8995,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-3.6008,3.0119,-1.2561,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "0.4359,-1.0113,-1.2762,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-6.315,0.9762,-0.6611,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "3.4453,-2.1891,-1.195,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "2.4229,-0.9646,-1.896,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "2.6443,1.4206,-1.2675,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "5.2818,-1.5979,0.312,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "4.2343,3.1743,-0.5548,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "6.8642,0.1634,1.0209,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "6.3451,2.5508,0.5901,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "1,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "1,9,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "2,12,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,34,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,15,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,16,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,8,1,0,0,0,0,,,,,,,,,,                                      \n" +
            "6,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,16,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,33,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,24,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "10,15,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "10,25,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "11,12,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "11,26,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,27,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,28,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,29,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,30,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,31,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,32,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "16,17,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "17,18,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "17,35,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "17,36,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "18,19,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "18,20,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "19,21,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "19,37,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "20,22,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "20,38,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "21,23,2,0,0,0,0,,,,,,,,,,                                    \n" +
            "21,39,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "22,23,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "22,40,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "23,41,1,0,0,0,0,,,,,,,,,,                                    \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            ",,,,,,,,,,,,,,,,                                             \n" +
            "RDX,,,,,,,,,,,,,,,,                                          \n" +
            "21,21,0,0,0,0,0,0,999,V2000,,,,,,,                           \n" +
            "-1.9565,2.8417,0.025,O,0,5,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-3.0687,-1.5771,0.0061,O,0,5,0,0,0,0,0,0,0,0,0,0,            \n" +
            "3.4394,0.2734,-0.0206,O,0,5,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.1804,3.4068,0.2043,O,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.4542,-3.0876,0.1777,O,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "2.8626,-1.8602,0.1593,O,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.384,1.3464,-0.2908,N,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-0.9751,-1.0018,-0.3003,N,0,0,0,0,0,0,0,0,0,0,0,0,           \n" +
            "1.354,-0.3396,-0.31,N,0,0,0,0,0,0,0,0,0,0,0,0,               \n" +
            "-0.7468,2.6261,0.0011,N,0,3,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-1.901,-1.9596,-0.018,N,0,3,0,0,0,0,0,0,0,0,0,0,             \n" +
            "2.6475,-0.6663,-0.0368,N,0,3,0,0,0,0,0,0,0,0,0,0,            \n" +
            "-1.3651,0.3431,0.1439,C,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "0.9814,1.0102,0.1344,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.386,-1.3554,0.1248,C,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "-1.4889,0.3698,1.2369,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "-2.3306,0.5879,-0.3181,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1.6685,1.7247,-0.3386,H,0,0,0,0,0,0,0,0,0,0,0,0,             \n" +
            "1.0836,1.0982,1.2265,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.429,-1.4906,1.2162,H,0,0,0,0,0,0,0,0,0,0,0,0,              \n" +
            "0.6539,-2.3048,-0.3591,H,0,0,0,0,0,0,0,0,0,0,0,0,            \n" +
            "1,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "2,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "3,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "4,10,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "5,11,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "6,12,2,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,10,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "7,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,11,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,13,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "8,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,12,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,14,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "9,15,1,0,0,0,0,,,,,,,,,,                                     \n" +
            "13,16,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "13,17,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,18,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "14,19,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "15,20,1,0,0,0,0,,,,,,,,,,                                    \n" +
            "15,21,1,0,0,0,0,,,,,,,,,,                                    \n";

        private readonly List<Animation> anims = new List<Animation>();

        static Chemicals()
        {
            CreateRadii();
            KnownMolecules = ParseChemicals(chemicals);
        }

        // add animated molecule

        public Chemicals(int w, int h) : base(w, h)
        {
        }

        internal static double LookupRadius(string name)
        {
            var i = name.Length - 1;
            while (i >= 0 && char.IsDigit(name[i]))
                i--;
            var symbol = name.Substring(0, i + 1);
            Debug.Assert(radii.Keys.Contains(symbol), "Missing symbol " + symbol);
            return radii[symbol];
        }


        internal static Color GetColor(string name)
        {
            var i = name.Length - 1;
            while (i >= 0 && char.IsDigit(name[i]))
                i--;
            var symbol = name.Substring(0, i + 1);
            switch (symbol)
            {
                case "H":
                    return Colors.Pink;
                case "C":
                    return Colors.Black;
                case "N":
                    return Colors.DarkBlue;
                case "O":
                    return Colors.Red;
                case "Fl":
                case "Cl":
                    return Colors.Green;
                case "Br":
                    return Colors.DarkRed;
                case "I":
                    return Colors.DarkViolet;
                case "He":
                case "Ne":
                case "Ar":
                case "Xe":
                case "Kr":
                    return Colors.Cyan;
                case "P":
                    return Colors.Orange;
                case "S":
                    return Colors.Yellow;
                case "B": // todo - also add most transition metals peach, salmon 
                    return Colors.Salmon;
                case "Li":
                case "Na":
                case "K":
                case "Rb":
                case "Cs":
                case "Fr":
                    return Colors.Violet;
                case "Be":
                case "Mg":
                case "Ca":
                case "Sr":
                case "Ba":
                case "Ra":
                    return Colors.DarkGreen;
                case "Ti":
                    return Colors.Gray;
                case "Fe":
                    return Colors.Orange;
                default:
                    return Colors.Pink;
            }
        }

        private static void CreateRadii()
        {
            radii = new Dictionary<string, double>();
            var lines = atomicRadii.Split(new[] {'\n'}, StringSplitOptions.RemoveEmptyEntries);
            foreach (var line in lines)
            {
                var words = line.Split(new[] {' ', '\t'}, StringSplitOptions.RemoveEmptyEntries).ToList();
                double radius;
                if (words.Count == 4 && double.TryParse(words[3], out radius))
                    radii.Add(words[1], radius/100.0); // picometers to angstroms
            }
        }

        private void AddAnimation(int frame, double scale)
        {
            var a = new Animation();

            var angle = Rand.NextDouble()*Math.PI*2;
            // var dx = Math.Cos(angle);
            // var dy = Math.Sin(angle);
            // var dist = 0; // Math.Max(Width/2, Height/2);

            var rx = Rand.NextDouble()*0.12;
            var ry = Rand.NextDouble()*0.12;
            var rz = Rand.NextDouble()*0.12;

            a.StartPosition = new Vector3D(-Width/2.0/scale, 0, 0);
            a.Molecule = KnownMolecules[KnownMolecules.Count - 1]; //rand.Next(KnownMolecules.Count)];
            a.RotationSpeed = new Vector3D(rx, ry, rz);
            a.TranslationSpeed = new Vector3D(1.0/scale, 0, 0);
            a.StartFrame = frame;
            anims.Add(a);
        }

        public override void Update()
        {
            base.Update();

            double scale = 7;

            while (anims.Count < 1)
            {
                AddAnimation(Frame, scale);
            }

            Fill(64, 64, 64);

            var balls = new List<Ball>();
            var lines = new List<Line3D>();
            foreach (var anim in anims)
            {
                double time = Frame - anim.StartFrame;
                var trans = time*anim.TranslationSpeed;
                var rot = time*anim.RotationSpeed;

                var mat =
                    //Matrix3D.Translation(trans.X, trans.Y, trans.Z) *
                    Matrix3D.XRotation(rot.X)*
                    Matrix3D.YRotation(rot.Y)*
                    Matrix3D.ZRotation(rot.Z)*
                    Matrix3D.Scale(scale, scale, scale);

                foreach (var m in anim.Molecule.Atoms)
                {
                    var pos = mat*m.Position;
                    var r = (byte) (m.Color.Red*255);
                    var g = (byte) (m.Color.Green*255);
                    var b = (byte) (m.Color.Blue*255);
                    balls.Add(
                        new Ball(new Raytracer.Math3D.Vector3D(pos.X, pos.Y, pos.Z),
                            m.Radius*scale,
                            new Renderer.Color(r, g, b)));
                }
                foreach (var bond in anim.Molecule.Bonds)
                {
                    var atom1 = anim.Molecule.Atoms[bond.Index1];
                    var atom2 = anim.Molecule.Atoms[bond.Index2];
                    Debug.Assert(atom1 != null && atom2 != null);

                    var p1 = mat*(atom1.Position);
                    var p2 = mat*(atom2.Position);
                    lines.Add(new Line3D {p1 = p1, p2 = p2, color = bond.Color});
                }
            }

            var cx = Width/2;
            var cy = Height/2;
            // todo - sort lines, balls, render
            foreach (var line in lines)
            {
                var x0 = (int) (line.p1.X + cx);
                var y0 = (int) (line.p1.Y + cy);
                var x1 = (int) (line.p2.X + cx);
                var y1 = (int) (line.p2.Y + cy);
                var r = (int) (line.color.Red);
                var g = (int) (line.color.Green);
                var b = (int) (line.color.Blue);
                DrawLine(x0, y0, x1, y1, r, g, b);
            }

            balls.Sort((a, b) => -a.Point.Z.CompareTo(b.Point.Z));
            foreach (var p in balls)
            {
                VectorBall(p.Point.X + cx, p.Point.Y + cy, p.Radius, p.Color.Red, p.Color.Green, p.Color.Blue);
            }
        }

        // conert chemical data to molecules
        private static List<Molecule> ParseChemicals(string data)
        {
            var lines = data.Split('\n');
            var sep = new[] {','};
            Molecule m = null;
            var ms = new List<Molecule>();
            int bondCount = 0, atomCount = 0;
            double x, y, z;
            int b1, b2, bt;
            foreach (var line in lines)
            {
                var words = line.
                    Split(sep, StringSplitOptions.RemoveEmptyEntries).
                    Select(w => w.Trim()).
                    Where(w => w.Length > 0).
                    ToList();
                if (words.Count == 1)
                {
                    // start molecule, end last one
                    if (m != null)
                    {
                        if (atomCount == 0 && bondCount == 0)
                            ms.Add(m);
                        else
                        {
                            Trace.TraceError("Wrong number of atoms or bonds in " + m.Name);
                            m = null;
                        }
                    }
                    m = new Molecule();
                    m.Name = words[0];
                    Trace.TraceInformation("Start molecule " + m.Name);
                }
                else if (words.Count == 10 && words[9] == "V2000")
                {
                    // counts
                    //    "5,4,0,0,0,0,0,0,999,V2000,,,,,,,                             \n" +
                    atomCount = Int32.Parse(words[0]);
                    bondCount = Int32.Parse(words[1]);
                }
                else if (words.Count >= 16 &&
                         Double.TryParse(words[0], out x) &&
                         Double.TryParse(words[1], out y) &&
                         Double.TryParse(words[2], out z)
                    )
                {
                    //    "0,0,0,C,0,0,0,0,0,0,0,0,0,0,0,0,                             \n" +
                    atomCount--;
                    var name = words[3];
                    var radius = LookupRadius(name); // 0.8; // todo - scale to fill?
                    var c = GetColor(name);
                    var color = new Raytracer.Color(c.R, c.G, c.B);
                    m.Atoms.Add(new Atom(name, radius, new Vector3D(x, y, z), color));
                }
                else if (words.Count == 7 &&
                         Int32.TryParse(words[0], out b1) &&
                         Int32.TryParse(words[1], out b2) &&
                         Int32.TryParse(words[2], out bt)
                    )
                {
                    //    "1,2,1,0,0,0,0,,,,,,,,,,                                      \n" +
                    bondCount--;
                    var color = bt == 1 ? new Raytracer.Color(255, 0, 0) : new Raytracer.Color(0, 255, 0);
                    m.Bonds.Add(new Bond(b1 - 1, b2 - 1, bt, m, color));
                }
                else if (words.Count != 0)
                {
                    Trace.TraceError("Unknown molecule format in " + m.Name);
                    m = null; // discard this one
                }
            }
            // add final one
            if (atomCount == 0 && bondCount == 0)
                ms.Add(m);
            else
            {
                Trace.TraceError("Wrong number of atoms or bonds in " + m.Name);
                m = null;
            }
            return ms;
        }

        #region Nested type: Animation

        private class Animation
        {
            public Vector3D StartPosition { get; set; }
            public Molecule Molecule { get; set; }
            public Vector3D RotationSpeed { get; set; }
            public Vector3D TranslationSpeed { get; set; }
            public int StartFrame { get; set; }
        }

        #endregion

        #region Nested type: Atom

        private class Atom
        {
            public Atom(string name, double radius, Vector3D position, Raytracer.Color color)
            {
                Name = name;
                Radius = radius;
                Position = position;
                Color = color;
            }

            public Raytracer.Color Color { get; private set; }
            public string Name { get; private set; }
            public double Radius { get; private set; }
            public Vector3D Position { get; private set; }
        }

        #endregion

        #region Nested type: Bond

        private class Bond
        {
            public Bond(int index1, int index2, int bondType, Molecule parent, Raytracer.Color color)
            {
                Index1 = index1;
                Index2 = index2;
                BondType = bondType;
                Parent = parent;
                Color = color;
            }

            public int Index1 { get; set; }
            public int Index2 { get; set; }

            public int BondType { get; set; }
            public Raytracer.Color Color { get; set; }

            public Molecule Parent { get; set; }
        }

        #endregion

        #region Nested type: Line3D

        private class Line3D
        {
            public Raytracer.Color color;
            public Vector3D p1, p2;
        }

        #endregion

        #region Nested type: Molecule

        private class Molecule
        {
            public Molecule()
            {
                Atoms = new List<Atom>();
                Bonds = new List<Bond>();
            }

            public List<Atom> Atoms { get; private set; }

            public List<Bond> Bonds { get; private set; }

            public string Name { get; set; }
        }

        #endregion

//number	symbol	name	radius in picometers (some estimated), 1 angstrom is 100 picometers
    }
}